<tal:master define="level options/level|python:0;
                    children options/children | nothing;
                    bottomLevel options/bottomLevel | nothing;"
            i18n:domain="g24.basetype">

<metal:main define-macro="threadview_main">
  <tal:navitem repeat="node children">
    <tal:item define="children node/children;
                      item node/item;
                      obj item/getObject;
                      heading_level python:level + 1"
              condition="python:bottomLevel &lt;= 0 or level &lt;= bottomLevel">

<li class=""
  tal:attributes="class string:threadview-level-${level}">

  <tal:article replace="structure python:view.element_provider(obj)"/>

  <ul
    class="threadview"
    tal:define="subthread python:view.recurse(children=children, level=level+1, bottomLevel=bottomLevel)"
    tal:condition="children"
    tal:content="structure subthread" />

</li>

    </tal:item>
  </tal:navitem>
</metal:main>
</tal:master>
